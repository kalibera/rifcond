* using log directory ‘/var/scratch2/tomas/test/mine/R-75396/check/pathview.Rcheck’
* using R Under development (unstable) (2018-10-04 r75396)
* using platform: x86_64-pc-linux-gnu (64-bit)
* using session charset: UTF-8
* checking for file ‘pathview/DESCRIPTION’ ... OK
* checking extension type ... Package
* this is package ‘pathview’ version ‘1.21.2’
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for executable files ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking for sufficient/correct file permissions ... OK
* checking whether package ‘pathview’ can be installed ... OK
* checking package directory ... OK
* checking ‘build’ directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the package can be unloaded cleanly ... OK
* checking whether the namespace can be loaded with stated dependencies ... OK
* checking whether the namespace can be unloaded cleanly ... OK
* checking loading without being on the library search path ... OK
* checking dependencies in R code ... WARNING
'::' or ':::' import not declared from: ‘BiocManager’
'loadNamespace' or 'requireNamespace' call not declared from: ‘BiocManager’
Package in Depends field not imported from: ‘org.Hs.eg.db’
  These packages need to be imported from (in the NAMESPACE file)
  for when this namespace is loaded but not attached.
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... NOTE
File ‘pathview/R/zzz.R’:
  .onLoad calls:
    installed.packages()
    packageStartupMessage(wordwrap(disclaimer, 80))

Package startup functions should not call ‘installed.packages’.
See section ‘Good practice’ in '?.onAttach'.

col.key: no visible binding for global variable ‘node.sizes’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/col.key.R:19-28)
cpd2kegg: no visible binding for global variable ‘rn.list’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/cpd2kegg.R:6)
cpdidmap: no visible binding for global variable ‘cpd.accs’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/cpdidmap.R:24)
cpdidmap: no visible binding for global variable ‘cpd.accs’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/cpdidmap.R:34)
cpdkegg2name: no visible binding for global variable ‘kegg.met’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/cpdkegg2name.R:21)
cpdname2kegg: no visible binding for global variable ‘cpd.names’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/cpdname2kegg.R:10)
cpdname2kegg: no visible binding for global variable ‘cpd.names’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/cpdname2kegg.R:14)
download.kegg: no visible global function definition for
  ‘download.file’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/download.kegg.R:36)
download.kegg: no visible global function definition for
  ‘download.file’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/download.kegg.R:53)
geneannot.map: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R:4)
geneannot.map: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R:6)
geneannot.map: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R:8)
geneannot.map: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R:10)
geneannot.map: no visible global function definition for
  ‘install.packages’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R:15-16)
geneannot.map: no visible global function definition for ‘columns’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R:24)
geneannot.map: no visible global function definition for ‘select’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R:46-49)
kegg.species.code: no visible binding for global variable ‘korg.1’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/kegg.species.code.R:11)
kegg.species.code: no visible binding for global variable ‘korg.1’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/kegg.species.code.R:14)
keggview.graph: no visible binding for global variable
  ‘KEGGEdgeSubtype’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/keggview.graph.R:142)
pathview: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/pathview.R:109)
pathview: no visible binding for global variable ‘rn.list’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/pathview.R:154)
sim.mol.data: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:25)
sim.mol.data: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:64)
sim.mol.data: no visible binding for global variable ‘bods’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:65)
sim.mol.data: no visible global function definition for
  ‘install.packages’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:68-69)
sim.mol.data: no visible global function definition for ‘keys’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:76)
sim.mol.data: no visible binding for global variable ‘cpd.accs’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:83)
sim.mol.data: no visible binding for global variable ‘rn.list’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:89)
sim.mol.data: no visible binding for global variable ‘ko.ids’
  (/var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/sim.mol.data.R:92)
subtypeDisplay,KEGGEdge: Error while checking: only works for closures
Undefined global functions or variables:
  KEGGEdgeSubtype bods columns cpd.accs cpd.names download.file
  install.packages kegg.met keys ko.ids korg.1 node.sizes rn.list
  select
Consider adding
  importFrom("utils", "download.file", "install.packages")
to your NAMESPACE file.
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking contents of ‘data’ directory ... OK
* checking data for non-ASCII characters ... OK
* checking data for ASCII and uncompressed saves ... OK
* checking sizes of PDF files under ‘inst/doc’ ... OK
* checking installed files from ‘inst/doc’ ... OK
* checking files in ‘vignettes’ ... OK
* checking examples ... ERROR
Running examples in ‘pathview-Ex.R’ failed
The error most likely occurred in:

> ### Name: eg2id
> ### Title: Mapping between different gene ID and annotation types
> ### Aliases: eg2id id2eg geneannot.map
> ### Keywords: ~kwd1 ~kwd2
> 
> ### ** Examples
> 
> data(gene.idtype.list)
> #generate simulated gene data named with non-KEGG/Entrez gene IDs
> gene.ensprot <- sim.mol.data(mol.type = "gene", id.type = gene.idtype.list[4], 
+     nmol = 50000)
Note: "ENSEMBLPROT" has only 24171 unique IDs!
> #construct map between non-KEGG ID and KEGG ID (Entrez gene)
> id.map.ensprot <- id2eg(ids = names(gene.ensprot), 
+     category = gene.idtype.list[4], org = "Hs")
'select()' returned 1:many mapping between keys and columns
> #Map molecular data onto Entrez Gene IDs
> gene.entrez <- mol.sum(mol.data = gene.ensprot, id.map = id.map.ensprot)
> #check the results
> head(gene.ensprot)
ENSP00000430147 ENSP00000454188 ENSP00000301490 ENSP00000428258 ENSP00000380283 
      0.2762701      -0.8449300       0.6166796      -0.9273487       1.6788952 
ENSP00000293350 
      2.6161189 
> head(id.map.ensprot)
     ENSEMBLPROT       ENTREZID
[1,] "ENSP00000430147" "51121" 
[2,] "ENSP00000454188" "23205" 
[3,] "ENSP00000301490" "254552"
[4,] "ENSP00000428258" "2669"  
[5,] "ENSP00000380283" "115330"
[6,] "ENSP00000293350" "126133"
> head(gene.entrez)
                                                              [,1]
10                                                      -1.1719676
1000                                                    -1.5445967
10000                                                   -1.6440136
100008586; 2574; 2576; 2578; 2579; 26748; 26749; 729408 -1.5186827
10002                                                   -0.4448764
100033411                                               -0.6578295
> 
> #map Entrez Gene to Gene Symbol and Name
> eg.symbname=eg2id(eg=id.map.ensprot[,2])
 ----------- FAILURE REPORT -------------- 
 --- srcref --- 
 at /var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/geneannot.map.R#32: 
 --- package (from environment) --- 
pathview
 --- call from context --- 
geneannot.map(in.ids = eg, in.type = "entrez", out.type = category, 
    org = org, pkg.name = pkg.name, ...)
 --- call from argument --- 
if (in.type == out.type) stop("in.type and out.type are the same, no need to map!")
 --- R stacktrace ---
where 1 at /var/scratch2/tomas/tmp/RtmpMVD1Pi/R.INSTALL5192e51e9cc/pathview/R/eg2id.R#6: geneannot.map(in.ids = eg, in.type = "entrez", out.type = category, 
    org = org, pkg.name = pkg.name, ...)
where 2: eg2id(eg = id.map.ensprot[, 2])

 --- value of length: 2 type: logical ---
[1] FALSE FALSE
 --- function from context --- 
function(in.ids, in.type, out.type, org="Hs", pkg.name=NULL, unique.map=TRUE, na.rm=TRUE, keep.order=TRUE){
  if(is.null(pkg.name)) {#pkg.name=paste("org", org, "eg.db", sep=".")
    data(bods)
    ridx=grep(tolower(paste0(org, "[.]")), tolower(bods[,1]))
    if(length(ridx)==0) {
      ridx=grep(tolower(org), tolower(bods[,2:3])) %% nrow(bods)
      if(length(ridx)==0) stop("Wrong org value!")
      if(any(ridx==0)) ridx[ridx==0]=nrow(bods)
    }
    pkg.name=bods[ridx,1]
  }

  pkg.on=try(requireNamespace(pkg.name),silent = TRUE)
  if(!pkg.on) {
    if (!requireNamespace("BiocManager", quietly=TRUE))
        install.packages("BiocManager")
    BiocManager::install(pkg.name, suppressUpdates =TRUE)
    pkg.on=try(requireNamespace(pkg.name),silent = TRUE)
    if(!pkg.on) stop(paste("Fail to install/load gene annotation package ", pkg.name, "!",  sep=""))
  }
  
  
  db.obj <- eval(parse(text=paste0(pkg.name, "::", pkg.name)))
  id.types <- columns(db.obj) #columns(eval(as.name(pkg.name)))

  in.type=toupper(in.type)
  out.type=toupper(out.type)
  eii=in.type==toupper("entrez") | in.type==toupper("eg")
  if(any(eii)) in.type[eii]="ENTREZID"
  eio=out.type==toupper("entrez") | out.type==toupper("eg")
  if(any(eio)) out.type[eio]="ENTREZID"
  if(in.type==out.type) stop("in.type and out.type are the same, no need to map!")
  
  nin=length(in.type)
  if(nin!=1) stop("in.type must be of length 1!")
  out.type=out.type[!out.type %in% in.type]
  nout=length(out.type)
  
  msg <-  paste0("must from: ", paste(id.types, collapse=", "), "!")
  if (! in.type %in% id.types) stop("'in.type' ", msg)
  if (! all(out.type %in% id.types)) stop("'out.type' ", msg)

  in.ids0=in.ids
  in.ids <- unique(as.character(in.ids))#unique necessary for select()# if(unique.map)
  out.ids=character(length(in.ids))
  res <- try(suppressWarnings(select(db.obj,
                                     keys = in.ids,
                                     keytype = in.type,
                                     columns=c(in.type, out.type))))
  if(class(res)=="data.frame"){
    
    res <- res[, c(in.type, out.type)]

    if(nout==1) na.idx <- is.na(res[,2])
    else na.idx <- apply(res[,-1],1,function(x) all(is.na(x)))
    if (sum(na.idx)>0) {
      n.na <- length(unique(res[na.idx, 1]))
      if (n.na>0) {
        print(paste("Note:", n.na, "of", length(in.ids), "unique input IDs unmapped."))
      }
      if (na.rm) res <- res[!na.idx, ]
    }

    cns=colnames(res)
    if(unique.map){
      if(length(out.type)==1)  umaps=tapply(res[,out.type], res[,in.type], paste, sep="", collapse="; ")
      else umaps=apply(res[,out.type], 2, function(x) tapply(x, res[,in.type], function(y) paste(unique(y), sep="", collapse="; ")))
      umaps=cbind(umaps)
      res.uniq=cbind(rownames(umaps), umaps)
      res=res.uniq
      colnames(res)=cns
    }

    res=as.matrix(res)
    if(!keep.order){
      rownames(res)=NULL
      return(res)
    } else {
      res1=matrix(NA, ncol=length(cns), nrow=length(in.ids0))
      res1[,1]=in.ids0
      rns=match(in.ids0, res[,1])
      res1[,-1]=res[rns,-1]
      colnames(res1)=cns
      return(res1)
    }
  } else{
    res=cbind(in.ids,out.ids)
    colnames(res)=c(in.type,out.type)
    return(res)
  }
}
<bytecode: 0x15aa8990>
<environment: namespace:pathview>
 --- function search by body ---
Function geneannot.map in namespace pathview has this body.
 ----------- END OF FAILURE REPORT -------------- 
Fatal error: the condition has length > 1
* checking for unstated dependencies in ‘tests’ ... OK
* checking tests ... OK
  Running ‘runTests.R’
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in ‘inst/doc’ ... OK
* checking running R code from vignettes ... OK
* checking re-building of vignette outputs ... OK
* checking PDF version of manual ... OK
* DONE
Status: 1 ERROR, 1 WARNING, 1 NOTE
